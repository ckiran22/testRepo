<!DOCTYPE html>
<html>
	<head>
		<h2>Directive Test</h2>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script src="vander_js/jquery/jquery-2.1.3.min.js"></script>
        <script src="vander_js/angular/angular.min.js"></script>
        <link rel="stylesheet" href="vendor_css/bootstrap/css/bootstrap.css" />
        <link rel="stylesheet" href="vendor_css/bootstrap/css/bootstrap-theme.css" />
        <script src="vendor_css/bootstrap/js/bootstrap.js" type="text/javascript"></script>
        <script src="application_js/enz-table.js" type="text/javascript"></script>
        <link rel="stylesheet" href="application_css/enz-table.css" />
	</head>

	<body>
        <div ng-app="enzTableModule" ng-controller="enzTableController">
            <script>
                var enzTableModule = angular.module("enzTableModule", ['enzTable']);
                enzTableModule.controller("enzTableController", function ($scope) {
                    $scope.columns = [{ name: 'Action', label: 'Action', template: "<a href='{{record.Id}}'>Edit</a>", templateUrl: '', disableSort: true, showAlways: false, hideOnSingle: true },
                        { name: 'Name', label: 'Name', template: "", templateUrl: '', disableSort: false, showAlways: true, margeFieldOnSingle: 'Action' },
                        { name: 'ObjectName.Name', label: 'Object Name', template: "<a href='{{record.Id}}'>{{record.ObjectName.Name}}</a>", templateUrl: '', disableSort: false, showAlways: true },
                        { name: 'Label', label: 'Label', template: '', templateUrl: '', disableSort: false, showAlways: false },
                        { name: 'Length', label: 'Length', template: '', templateUrl: '', disableSort: false, showAlways: false },
                        { name: 'SystemType', label: 'System Type', template: '', templateUrl: '', disableSort: false, showAlways: false },
                        { name: 'Scale', label: 'Scale', template: '', templateUrl: '', disableSort: false, showAlways: false },
                        { name: 'IsRequired', label: 'IsRequired', template: '', templateUrl: '', disableSort: false, showAlways: false },
                        { name: 'OwnerId', label: 'OwnerId', template: '', templateUrl: '', disableSort: false, showAlways: false },
                        { name: 'IsUnique', label: 'IsUnique', template: '', templateUrl: '', disableSort: false, showAlways: false },
                        { name: 'DisplayAs', label: 'Display As', template: '', templateUrl: '', disableSort: false, showAlways: false }];

                    $scope.test = function (record, column) {
                        console.log(record);
                    }

                    $scope.object = { objectName: 'FieldDef', queryfields: 'Id, Name, Scale, OwnerId, IsUnique, IsRequired, ObjectName.Name, Label, DisplayAs, SystemType', criteria: "Name != ''" };
                    $scope.sortOrder = [{ name: 'Name', direction: 'asc' }];


                    $scope.testData = [
                        { "DisplayAs": "PickList", "DBType": "nvarchar", "SystemType": "String", "ObjectName": { "Name": "Sharing", "ObjType": "ObjectDef" }, "Label": "Access", "IsUnique": false, "EncryptionType": "None", "IsRequired": false, "Length": 120, "Scale": 0, "OnParentDelete": "DoNothing", "OwnerId": "aaaeaaaaaaaaaaaaab", "Id": "aaacaaaaaaaaaaaaof", "Name": "Access", "RecordAccess": "A", "ObjType": "FieldDef" },
                        { "DisplayAs": "PickList", "DBType": "nvarchar", "SystemType": "String", "ObjectName": { "Name": "SharingRuleUserOrGroupAccess", "ObjType": "ObjectDef" }, "Label": "Access", "IsUnique": false, "EncryptionType": "None", "IsRequired": true, "Length": 120, "Scale": 0, "OnParentDelete": "DoNothing", "OwnerId": "aaaeaaaaaaaaaaaaab", "Id": "aaacaaaaaaaaaaaaor", "Name": "Access", "RecordAccess": "A", "ObjType": "FieldDef" },
                        { "DisplayAs": "ReferenceById", "DBType": "nchar", "SystemType": "DatabaseObject", "ObjectName": { "Name": "User", "ObjType": "ObjectDef" }, "Label": "Account", "IsUnique": false, "EncryptionType": "None", "IsRequired": true, "Length": 18, "Scale": 0, "OnParentDelete": "DoNothing", "OwnerId": "aaaeaaaaaaaaaaaaab", "Id": "aaacaaaaaaaaaaaaaw", "Name": "Account", "RecordAccess": "A", "ObjType": "FieldDef" },
                        { "DisplayAs": "ReferenceById", "DBType": "nchar", "SystemType": "DatabaseObject", "ObjectName": { "Name": "Attachment", "ObjType": "ObjectDef" }, "Label": "Account", "IsUnique": false, "EncryptionType": "None", "IsRequired": false, "Length": 18, "Scale": 0, "OnParentDelete": "DoNothing", "OwnerId": "aaaeaaaaaaaaaaaaab", "Id": "aaacaaaaaaaaaaabcl", "Name": "Account", "RecordAccess": "A", "ObjType": "FieldDef" },

                    ];

                    //$scope.getData = function (callback, object, queryFields, criteria, sortOrder, keyword, offset, size) {
                    //    var url = '@SystemVars.ApplicationBaseUrl/controls/TableView?fields=' + queryFields + '&criteria=' + criteria + '&objectName=' + object;
                    //    if (keyword)
                    //        url += "&searchkeyword=" + keyword;
                    //    var orderBy = '';
                    //    if (sortOrder) {
                    //        angular.forEach(sortOrder, function (sort) {
                    //            var direction = null;
                    //            if (sort.direction)
                    //                direction = sort.direction;
                    //            if (direction)
                    //                orderBy += '[' + sort.name + '] ' + direction + ',';
                    //        });
                    //        orderBy = orderBy.substr(0, orderBy.length - 1);
                    //    }
                    //    if (orderBy)
                    //        url += '&orderBy=' + orderBy;
                    //    if (size && offset >= 0)
                    //        url += '&pageSize=' + size + '&page=' + offset;
                    //    Engine.get(url, function (error) {
                    //        if (error.Success) {
                    //            if (typeof callback == "function") {
                    //                var retData = {};
                    //                retData["Data"] = error.Data;
                    //                retData["TotalCount"] = error.TotalRecords;

                    //                callback.call(this, retData);
                    //            }
                    //        }
                    //        else
                    //            alert(error.DebugMessage);
                    //    })
                    //}
                    $scope.getData = function (callback, object, queryFields, criteria, sortOrder, keyword, offset, size) {
                        setTimeout(function () {
                            if (typeof callback == "function") {
                                var retData = {};
                                retData["Data"] = $scope.testData;
                                retData["TotalCount"] = $scope.testData.length;

                                callback.call(this, retData);
                            }
                        }, 1000);
                    }

                })

            </script>
            <enz-table columns="columns" getdata="getData(callback, object, queryFields, criteria, sortOrder, keyword, offset, size)" sortorder="sortOrder" object="object"></enz-table>


        </div>
	</body>
</html>





